<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="1" author="DynamicDataStore">
        <createTable tableName="DWH_API_AUTHORIZATION_SETTING">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DWH_API_AUTHORIZATION_SETTING"/>
            </column>
            <column name="VERSION" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="CREATED_DATE" type="timestamp with time zone"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_DATE" type="timestamp with time zone"/>
            <column name="DELETED_BY" type="VARCHAR(255)"/>
            <column name="DELETED_DATE" type="timestamp with time zone"/>
            <column name="AUTH_TYPE" type="VARCHAR(255)"/>
            <column name="USERNAME" type="VARCHAR(255)"/>
            <column name="PASSWORD" type="VARCHAR(255)"/>
            <column name="BEARER_TOKEN" type="CLOB"/>
            <column name="API_KEY_NAME" type="VARCHAR(255)"/>
            <column name="API_KEY_VALUE" type="VARCHAR(255)"/>
            <column name="API_KEY_PLACEMENT" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="2" author="DynamicDataStore">
        <createTable tableName="DWH_API_BODY">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DWH_API_BODY"/>
            </column>
            <column name="VERSION" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="CREATED_DATE" type="timestamp with time zone"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_DATE" type="timestamp with time zone"/>
            <column name="DELETED_BY" type="VARCHAR(255)"/>
            <column name="DELETED_DATE" type="timestamp with time zone"/>
            <column name="BODY_TYPE" type="VARCHAR(255)"/>
            <column name="RAW_TYPE" type="VARCHAR(255)"/>
            <column name="RAW_CONTENT" type="CLOB"/>
            <column name="BINARY_FILE_NAME" type="VARCHAR(255)"/>
            <column name="BINARY_FILE_CONTENT" type="BLOB"/>
        </createTable>
    </changeSet>
    <changeSet id="3" author="DynamicDataStore">
        <createTable tableName="DWH_API_FORM_DATA_FIELD">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DWH_API_FORM_DATA_FIELD"/>
            </column>
            <column name="VERSION" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="CREATED_DATE" type="timestamp with time zone"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_DATE" type="timestamp with time zone"/>
            <column name="DELETED_BY" type="VARCHAR(255)"/>
            <column name="DELETED_DATE" type="timestamp with time zone"/>
            <column name="FORM_KEY" type="VARCHAR(255)"/>
            <column name="FORM_VALUE" type="VARCHAR(255)"/>
            <column name="DESCRIPTION" type="VARCHAR(255)"/>
            <column name="DATA_TYPE" type="VARCHAR(255)"/>
            <column name="FILE_NAME" type="VARCHAR(255)"/>
            <column name="FILE_CONTENT" type="BLOB"/>
            <column name="API_BODY_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="4" author="DynamicDataStore">
        <createTable tableName="DWH_API_HEADERS">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DWH_API_HEADERS"/>
            </column>
            <column name="VERSION" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="CREATED_DATE" type="timestamp with time zone"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_DATE" type="timestamp with time zone"/>
            <column name="DELETED_BY" type="VARCHAR(255)"/>
            <column name="DELETED_DATE" type="timestamp with time zone"/>
            <column name="HEADER_KEY" type="VARCHAR(255)"/>
            <column name="HEADER_VALUE" type="VARCHAR(255)"/>
            <column name="DESCRIPTION" type="VARCHAR(255)"/>
            <column name="API_SETTING_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="5" author="DynamicDataStore">
        <createTable tableName="DWH_API_QUERY_PARAM">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DWH_API_QUERY_PARAM"/>
            </column>
            <column name="VERSION" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="CREATED_DATE" type="timestamp with time zone"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_DATE" type="timestamp with time zone"/>
            <column name="DELETED_BY" type="VARCHAR(255)"/>
            <column name="DELETED_DATE" type="timestamp with time zone"/>
            <column name="QP_KEY" type="VARCHAR(255)"/>
            <column name="QP_VALUE" type="VARCHAR(255)"/>
            <column name="DESCRIPTION" type="VARCHAR(255)"/>
            <column name="IS_ENABLE" type="BOOLEAN"/>
            <column name="API_SETTING_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="6" author="DynamicDataStore">
        <createTable tableName="DWH_API_SETTING">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DWH_API_SETTING"/>
            </column>
            <column name="VERSION" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="CREATED_DATE" type="timestamp with time zone"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_DATE" type="timestamp with time zone"/>
            <column name="DELETED_BY" type="VARCHAR(255)"/>
            <column name="DELETED_DATE" type="timestamp with time zone"/>
            <column name="API_BODY_ID" type="UUID"/>
            <column name="NAME" type="VARCHAR(255)"/>
            <column name="BASE_URL" type="VARCHAR(255)"/>
            <column name="FINAL_URL" type="VARCHAR(255)"/>
            <column name="HTTP_METHOD" type="VARCHAR(255)"/>
            <column name="AUTHORIZATION_ID" type="UUID"/>
            <column name="POST_RESPONSE_SCRIPT" type="CLOB"/>
            <column name="USE_RAW_URL" type="BOOLEAN"/>
        </createTable>
    </changeSet>
    <changeSet id="7" author="DynamicDataStore">
        <createTable tableName="DWH_API_URL_ENCODED_FIELD">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DWH_API_URL_ENCODED_FIELD"/>
            </column>
            <column name="VERSION" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="CREATED_DATE" type="timestamp with time zone"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_DATE" type="timestamp with time zone"/>
            <column name="DELETED_BY" type="VARCHAR(255)"/>
            <column name="DELETED_DATE" type="timestamp with time zone"/>
            <column name="KEY_" type="VARCHAR(255)"/>
            <column name="VALUE_" type="VARCHAR(255)"/>
            <column name="DESCRIPTION" type="VARCHAR(255)"/>
            <column name="API_BODY_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="8" author="DynamicDataStore">
        <createIndex indexName="IDX_DWH_API_FORM_DATA_FIELD_API_BODY" tableName="DWH_API_FORM_DATA_FIELD">
            <column name="API_BODY_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="API_BODY_ID" baseTableName="DWH_API_FORM_DATA_FIELD"
                                 constraintName="FK_DWH_API_FORM_DATA_FIELD_ON_API_BODY" referencedColumnNames="ID"
                                 referencedTableName="DWH_API_BODY"/>
    </changeSet>
    <changeSet id="9" author="DynamicDataStore">
        <createIndex indexName="IDX_DWH_API_HEADERS_API_SETTING" tableName="DWH_API_HEADERS">
            <column name="API_SETTING_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="API_SETTING_ID" baseTableName="DWH_API_HEADERS"
                                 constraintName="FK_DWH_API_HEADERS_ON_API_SETTING" referencedColumnNames="ID"
                                 referencedTableName="DWH_API_SETTING"/>
    </changeSet>
    <changeSet id="10" author="DynamicDataStore">
        <createIndex indexName="IDX_DWH_API_QUERY_PARAM_API_SETTING" tableName="DWH_API_QUERY_PARAM">
            <column name="API_SETTING_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="API_SETTING_ID" baseTableName="DWH_API_QUERY_PARAM"
                                 constraintName="FK_DWH_API_QUERY_PARAM_ON_API_SETTING" referencedColumnNames="ID"
                                 referencedTableName="DWH_API_SETTING"/>
    </changeSet>
    <changeSet id="11" author="DynamicDataStore">
        <createIndex indexName="IDX_DWH_API_SETTING_API_BODY" tableName="DWH_API_SETTING">
            <column name="API_BODY_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="API_BODY_ID" baseTableName="DWH_API_SETTING"
                                 constraintName="FK_DWH_API_SETTING_ON_API_BODY" referencedColumnNames="ID"
                                 referencedTableName="DWH_API_BODY"/>
    </changeSet>
    <changeSet id="12" author="DynamicDataStore">
        <createIndex indexName="IDX_DWH_API_SETTING_AUTHORIZATION" tableName="DWH_API_SETTING">
            <column name="AUTHORIZATION_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="AUTHORIZATION_ID" baseTableName="DWH_API_SETTING"
                                 constraintName="FK_DWH_API_SETTING_ON_AUTHORIZATION" referencedColumnNames="ID"
                                 referencedTableName="DWH_API_AUTHORIZATION_SETTING"/>
    </changeSet>
    <changeSet id="13" author="DynamicDataStore">
        <createIndex indexName="IDX_DWH_API_URL_ENCODED_FIELD_API_BODY" tableName="DWH_API_URL_ENCODED_FIELD">
            <column name="API_BODY_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="API_BODY_ID" baseTableName="DWH_API_URL_ENCODED_FIELD"
                                 constraintName="FK_DWH_API_URL_ENCODED_FIELD_ON_API_BODY" referencedColumnNames="ID"
                                 referencedTableName="DWH_API_BODY"/>
    </changeSet>
</databaseChangeLog>